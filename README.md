# Архиватор файлов по ссылкам

## Описание
Сервис позволяет пользователю создавать задачи на скачивание файлов по ссылкам, архивировать их в zip и получать архив. Поддерживаются только файлы с расширениями `.pdf` и `.jpeg`. Все данные хранятся в памяти, без использования внешних БД и инфраструктуры.

## Возможности
- Создание задачи на архивирование файлов
- Добавление ссылок на файлы в задачу
- Проверка статуса задачи, получение ошибок по недоступным файлам
- Получение ссылки на архив после добавления 3 файлов
- Скачивание архива по ссылке
- Ограничение: не более 3 задач одновременно, не более 3 файлов в задаче
- Фильтрация по расширениям: только `.pdf`, `.jpeg`

## Архитектура
- **models** — структуры данных (Task, FileInfo, FileError)
- **repository** — in-memory хранилище задач
- **service** — бизнес-логика, скачивание, архивирование, статусы
- **handler** — обработчики HTTP-запросов, DTO, Swagger
- **router** — маршрутизация эндпоинтов
- **response** — структуры для ответов API
- **logger** — логгирование через zap
- **utils** — утилиты для скачивания и архивирования

## Эндпоинты
- `POST /tasks` — создать задачу
- `POST /tasks/{id}/files` — добавить файл в задачу
- `GET /tasks/{id}` — получить статус задачи
- `GET /archive/{id}` — скачать архив
- `GET /swagger/index.html` — Swagger UI


## Запуск
1. Убедитесь, что установлен Go >= 1.18
2. Клонируйте репозиторий
3. В корне проекта выполните:
   ```bash
   go run cmd/main.go
   ```
4. Сервер запустится на порту 8080

## Тесты
В проекте реализованы unit-тесты для репозитория и сервиса.
Для запуска всех тестов выполните:
```bash
go test ./...
```
Тесты автоматически проверяют лимиты, обработку ошибок, удаление файлов и бизнес-логику.

## Swagger
Документация API доступна по адресу:
http://localhost:8080/swagger/index.html

## Примеры запросов
- Создать задачу:
  ```bash
  curl -X POST http://localhost:8080/tasks
  ```
- Добавить файл:
  ```bash
  curl -X POST -H "Content-Type: application/json" -d '{"url":"https://example.com/file.pdf"}' http://localhost:8080/tasks/{id}/files
  ```
- Получить статус:
  ```bash
  curl http://localhost:8080/tasks/{id}
  ```
- Скачать архив:
  ```bash
  curl -O http://localhost:8080/archive/{id}
  ```

## Паттерны и лучшие практики
- Чистая архитектура: разделение слоёв, инъекция зависимостей
- DTO для ответов API
- Логгирование всех операций
- Swagger для документации
- Все ошибки возвращаются в API

## Ограничения и нюансы
- Все данные хранятся в памяти, при перезапуске сервера задачи теряются
- Архив остаётся доступен для скачивания, исходные файлы удаляются после первого скачивания
- Если файл недоступен — ошибка возвращается в статусе задачи, остальные файлы архивируются
- Нет поддержки Docker, БД, внешних сервисов

## Оценка и запуск
- Код протестирован, все ограничения реализованы
- Если возникнут вопросы по запуску — проверьте версию Go и права на создание папки `temp`
- Swagger доступен по адресу `/swagger/index.html`

---
